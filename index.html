<html>
  <head>
    <link type="text/css" rel="stylesheet" href="/css/main.css" />
	
  </head>
  <body>
	<!-- <a href="{{ url }}">{{ url_linktext }}</a> -->
	
	<div id="answer">
		{% if value: %}
		{{ value }} {{toLongName}}
		<br>
		-->
		<br>
		{% endif %}
	</div>
	
	
	<form action="/convert" method="post">
		<input type="text" name="number" id="input" value="{{ number }}">
		<div id="fromUnitDiv">
			<select id="fromUnit" name="fromUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">
			  <option value="{{fromUnit}}">{{fromUnit}}</option> 
			{% for fromUnit in fromUnitSet: %}
			  
			  <option value="{{fromUnit}}">{{fromUnit}}</option> 
			{% endfor %}
			</select>
		</div>
		to
		<select name="toUnit" id="toUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">
          <option value="{{toUnit}}">{{toUnit}}</option> 
		{% for toUnit in toUnitSet: %}
		  
          <option value="{{toUnit}}">{{toUnit}}</option> 
		{% endfor %}
		</select>
		
		
		<br><input type="submit" value="Convert it dude" id="button">
	</form>
	
	<!--<div id="recentConversions">
	Recent conversions:<br>
	
	{% for pastConversion in pastConversions %}
	  {{ pastConversion.value }} {{pastConversion.fromUnit }} to {{pastConversion.toUnit}}
	  <br>
    {% endfor %}
	</div>-->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
  <script src="/js/chosen/chosen.jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript"> $(".chzn-select").chosen();</script>
  <script type="text/javascript">
	$(document).ready(function(){

	  $("#fromUnit").change(function(){
		console.log('from unit changed');
		//ajax post
		$.post("/getToUnits", { fromUnit: $("#fromUnit").val()},
		   function(data) {
			 jsonData = jQuery.parseJSON(data);
			 options = '';
			 for (var i=0; i<jsonData.length; i++) {
				options+= '<option value="'+jsonData[i]+'">'+jsonData[i]+'</option>'
			 }
			 //console.log(options);
			 $("select#toUnit").html(options); //works for regular select boxes, but not for the special one...
		   });
	  });
	});
	</script>
  </body>
</html>