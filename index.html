<html>
  <head>
	<title>wtfconverter - converter mundane units into awesome units</title>
	<meta name="description" content="Convert mundane units into awesome units. Revolutionizing the world of unit conversions since 1929." />
    <link type="text/css" rel="stylesheet" href="/css/main.css" />
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-32846618-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
  </head>
  <body>
	<!-- <a href="{{ url }}">{{ url_linktext }}</a> -->
	
	<!-- Begin: adBrite, Generated: 2012-06-21 16:51:36  -->
	<script type="text/javascript">
	var AdBrite_Title_Color = '0000FF';
	var AdBrite_Text_Color = '000000';
	var AdBrite_Background_Color = 'FFFFFF';
	var AdBrite_Border_Color = 'CCCCCC';
	var AdBrite_URL_Color = '008000';
	try{var AdBrite_Iframe=window.top!=window.self?2:1;var AdBrite_Referrer=document.referrer==''?document.location:document.referrer;AdBrite_Referrer=encodeURIComponent(AdBrite_Referrer);}catch(e){var AdBrite_Iframe='';var AdBrite_Referrer='';}
	</script>
	<span style="white-space:nowrap;"><script type="text/javascript">document.write(String.fromCharCode(60,83,67,82,73,80,84));document.write(' src="http://ads.adbrite.com/mb/text_group.php?sid=2171592&zs=3732385f3930&ifr='+AdBrite_Iframe+'&ref='+AdBrite_Referrer+'" type="text/javascript">');document.write(String.fromCharCode(60,47,83,67,82,73,80,84,62));</script>
	<a target="_top" href="http://www.adbrite.com/mb/commerce/purchase_form.php?opid=2171592&afsid=1"><img src="http://files.adbrite.com/mb/images/adbrite-your-ad-here-leaderboard.gif" style="background-color:#CCCCCC;border:none;padding:0;margin:0;" alt="Your Ad Here" width="14" height="90" border="0" /></a></span>
	<!-- End: adBrite -->
		
	<div id="answer">
		{% if value: %}
		{{ number }} {{fromUnit}}		
		<br>
		=>
		<br>
		{{ value }} {{toLongName}}
		{% endif %}
	</div>
	<div id="unitDescription">
	{%if unitDesc: %}
		{{ unitDesc }}
	{% endif %}
	</div>
	
	{% if not toLongName: %}
	<form action="/convert" method="post">
		<input type="text" name="number" id="input" value="">
		
		<select id="fromUnit" name="fromUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">
		  <option value=""></option> 
		{% for fromUnit in fromUnitSet: %}
		  
		  <option value="{{fromUnit}}">{{fromUnit}}</option> 
		{% endfor %}
		</select>
		
		to

		<select name="toUnit" id="toUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">
		</select>
		
		<br><input type="submit" value="Convert it dude" id="button">
	</form>
	{% else: %}
	<a id = "backlink" href="/">&larr; Back to the converter, yo</a>
	{% endif %}
	
	<!--<div id="recentConversions">
	Recent conversions:<br>
	
	{% for pastConversion in pastConversions %}
	  {{ pastConversion.value }} {{pastConversion.fromUnit }} to {{pastConversion.toUnit}}
	  <br>
    {% endfor %}
	</div>-->
	<div id="footer">
		<ul>
			<li><a href='mailto:emailwtfconverter@gmail.com'>Make a suggestion</li>
			<li><a href='mailto:emailwtfconverter@gmail.com'>Contact</a></li>
		</ul>
	</div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script src="/js/chosen/chosen.jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript"> $(".chzn-select").chosen();</script>
  
  <script type="text/javascript">
	$(document).ready(function(){

	  $("#fromUnit").change(function(){
		console.log('from unit changed');
		//ajax post
		$.post("/getToUnits", { fromUnit: $("#fromUnit").val()},
		   function(data) {
			 jsonData = jQuery.parseJSON(data);
			 options = '';
			 //options += '<select name="toUnit" id="toUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">'
			 for (var i=0; i<jsonData.length; i++) {
				options+= '<option value="'+jsonData[i]+'">'+jsonData[i]+'</option>'
			 }
			 //options+='</select>'
			 console.log(options);
			 //NEXT THING TO TRY: creating the entire select box html from scratch
			 $("select#toUnit").html(options); //works for regular select boxes, but not for the special one...
			 $("select#toUnit").trigger("liszt:updated");
		   });
	  });
	});
	</script>
  </body>
</html>