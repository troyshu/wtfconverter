<html>
  <head>
	<title>wtfconverter - converter mundane units into awesome units</title>
	<meta name="description" content="Convert mundane units into awesome units. Revolutionizing the world of unit conversions since 1929." />
    <link type="text/css" rel="stylesheet" href="/css/main.css" />
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-32846618-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
  </head>
  <body>
	<!-- <a href="{{ url }}">{{ url_linktext }}</a> -->
	
	<!--adsense-->
	<script type="text/javascript"><!--
	google_ad_client = "ca-pub-4737855000959807";
	/* wtfconverter */
	google_ad_slot = "3493649670";
	google_ad_width = 728;
	google_ad_height = 90;
	//-->
	</script>
	<script type="text/javascript"
	src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
	</script>
	
	<div id="answer">
		{% if value: %}
		{{ number }} {{fromUnit}}		
		<br>
		=>
		<br>
		{{ value }} {{toLongName}}
		{% endif %}
	</div>
	<div id="unitDescription">
	{%if unitDesc: %}
		{{ unitDesc }}
	{% endif %}
	</div>
	
	{% if not toLongName: %}
	<form action="/convert" method="post">
		<input type="text" name="number" id="input" value="">
		
		<select id="fromUnit" name="fromUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">
		  <option value=""></option> 
		{% for fromUnit in fromUnitSet: %}
		  
		  <option value="{{fromUnit}}">{{fromUnit}}</option> 
		{% endfor %}
		</select>
		
		to

		<select name="toUnit" id="toUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">
		</select>
		
		<br><input type="submit" value="Convert it dude" id="button">
	</form>
	{% else: %}
	<a id = "backlink" href="/">&larr; Back to the converter, yo</a>
	{% endif %}
	
	<!--<div id="recentConversions">
	Recent conversions:<br>
	
	{% for pastConversion in pastConversions %}
	  {{ pastConversion.value }} {{pastConversion.fromUnit }} to {{pastConversion.toUnit}}
	  <br>
    {% endfor %}
	</div>-->
	<div id="footer">
		<ul>
			<li><a href='mailto:emailwtfconverter@gmail.com'>Make a suggestion</li>
			<li><a href='mailto:emailwtfconverter@gmail.com'>Contact</a></li>
		</ul>
	</div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script src="/js/chosen/chosen.jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript"> $(".chzn-select").chosen();</script>
  
  <script type="text/javascript">
	$(document).ready(function(){

	  $("#fromUnit").change(function(){
		console.log('from unit changed');
		//ajax post
		$.post("/getToUnits", { fromUnit: $("#fromUnit").val()},
		   function(data) {
			 jsonData = jQuery.parseJSON(data);
			 options = '';
			 //options += '<select name="toUnit" id="toUnit" data-placeholder="Choose a unit..." class="chzn-select" style="width:350px;">'
			 for (var i=0; i<jsonData.length; i++) {
				options+= '<option value="'+jsonData[i]+'">'+jsonData[i]+'</option>'
			 }
			 //options+='</select>'
			 console.log(options);
			 //NEXT THING TO TRY: creating the entire select box html from scratch
			 $("select#toUnit").html(options); //works for regular select boxes, but not for the special one...
			 $("select#toUnit").trigger("liszt:updated");
		   });
	  });
	});
	</script>
  </body>
</html>